___TERMS_OF_SERVICE___

By creating or modifying this file you agree to Google Tag Manager's Community
Template Gallery Developer Terms of Service available at
https://developers.google.com/tag-manager/gallery-tos (or such other URL as
Google may provide), as modified from time to time.


___INFO___

{
  "type": "TAG",
  "id": "cvt_temp_public_id",
  "version": 1,
  "securityGroups": [],
  "displayName": "Cookie Information Consent Mode",
  "categories": [
    "TAG_MANAGEMENT",
    "ADVERTISING",
    "ANALYTICS"
  ],
  "brand": {
    "id": "github.com_cookie-information",
    "displayName": "cookie-information",
    "thumbnail": "data:image/jpeg;base64,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"
  },
  "description": "Adjust behaviour of Google Tags (advertising, analytics, and use of cookies) based on user consent choice using Google\u0027s Consent API.",
  "containerContexts": [
    "WEB"
  ]
}


___TEMPLATE_PARAMETERS___

[
  {
    "type": "SELECT",
    "name": "command",
    "displayName": "Command for default consent",
    "macrosInSelect": true,
    "selectItems": [
      {
        "value": "default",
        "displayValue": "Default"
      },
      {
        "value": "update",
        "displayValue": "Update"
      }
    ],
    "simpleValueType": true
  },
  {
    "type": "GROUP",
    "name": "defaultSettings",
    "displayName": "Default Consent Settings",
    "groupStyle": "NO_ZIPPY",
    "subParams": [
      {
        "type": "PARAM_TABLE",
        "name": "settingsTable",
        "displayName": "settingsTable",
        "paramTableColumns": [
          {
            "param": {
              "type": "SELECT",
              "name": "ad_storage",
              "displayName": "Ads",
              "macrosInSelect": true,
              "selectItems": [
                {
                  "value": "granted",
                  "displayValue": "granted"
                },
                {
                  "value": "denied",
                  "displayValue": "denied"
                }
              ],
              "simpleValueType": true,
              "defaultValue": "denied"
            },
            "isUnique": false
          },
          {
            "param": {
              "type": "SELECT",
              "name": "analytics_storage",
              "displayName": "analytics",
              "macrosInSelect": true,
              "selectItems": [
                {
                  "value": "granted",
                  "displayValue": "granted"
                },
                {
                  "value": "denied",
                  "displayValue": "denied"
                }
              ],
              "simpleValueType": true,
              "defaultValue": "denied"
            },
            "isUnique": false
          },
          {
            "param": {
              "type": "SELECT",
              "name": "functionality_storage",
              "displayName": "functionality",
              "macrosInSelect": true,
              "selectItems": [
                {
                  "value": "granted",
                  "displayValue": "granted"
                },
                {
                  "value": "denied",
                  "displayValue": "denied"
                }
              ],
              "simpleValueType": true,
              "defaultValue": "denied"
            },
            "isUnique": false
          },
          {
            "param": {
              "type": "SELECT",
              "name": "personalization_storage",
              "displayName": "personalization",
              "macrosInSelect": true,
              "selectItems": [
                {
                  "value": "granted",
                  "displayValue": "granted"
                },
                {
                  "value": "denied",
                  "displayValue": "denied"
                }
              ],
              "simpleValueType": true,
              "defaultValue": "denied"
            },
            "isUnique": false
          },
          {
            "param": {
              "type": "SELECT",
              "name": "security_storage",
              "displayName": "security",
              "macrosInSelect": true,
              "selectItems": [
                {
                  "value": "granted",
                  "displayValue": "granted"
                },
                {
                  "value": "denied",
                  "displayValue": "denied"
                }
              ],
              "simpleValueType": true,
              "defaultValue": "granted"
            },
            "isUnique": false
          },
          {
            "param": {
              "type": "TEXT",
              "name": "regions",
              "displayName": "regions",
              "simpleValueType": true,
              "defaultValue": "all"
            },
            "isUnique": false
          },
          {
            "param": {
              "type": "TEXT",
              "name": "wait_for_update",
              "displayName": "update wait",
              "simpleValueType": true,
              "valueUnit": "milliseconds",
              "defaultValue": 500
            },
            "isUnique": false
          }
        ]
      }
    ]
  },
  {
    "type": "GROUP",
    "name": "updateSettings",
    "displayName": "Update Consent Settings",
    "groupStyle": "NO_ZIPPY",
    "subParams": [
      {
        "type": "SELECT",
        "name": "ad_storage_update",
        "displayName": "Update Ad Storage",
        "macrosInSelect": true,
        "selectItems": [
          {
            "value": "granted",
            "displayValue": "granted"
          },
          {
            "value": "denied",
            "displayValue": "denied"
          }
        ],
        "simpleValueType": true,
        "defaultValue": "granted"
      },
      {
        "type": "SELECT",
        "name": "analytics_storage_update",
        "displayName": "Update Analytics Storage",
        "macrosInSelect": true,
        "selectItems": [
          {
            "value": "granted",
            "displayValue": "granted"
          },
          {
            "value": "denied",
            "displayValue": "denied"
          }
        ],
        "simpleValueType": true,
        "defaultValue": "granted"
      },
      {
        "type": "SELECT",
        "name": "functionality_storage_update",
        "displayName": "update ads",
        "macrosInSelect": true,
        "selectItems": [
          {
            "value": "granted",
            "displayValue": "granted"
          },
          {
            "value": "denied",
            "displayValue": "denied"
          }
        ],
        "simpleValueType": true
      },
      {
        "type": "SELECT",
        "name": "personalization_storage_update",
        "displayName": "update functionality",
        "macrosInSelect": true,
        "selectItems": [
          {
            "value": "granted",
            "displayValue": "granted"
          },
          {
            "value": "denied",
            "displayValue": "denied"
          }
        ],
        "simpleValueType": true
      },
      {
        "type": "SELECT",
        "name": "security_storage_update",
        "displayName": "security update",
        "macrosInSelect": true,
        "selectItems": [
          {
            "value": "granted",
            "displayValue": "granted"
          },
          {
            "value": "denied",
            "displayValue": "denied"
          }
        ],
        "simpleValueType": true
      }
    ],
    "enablingConditions": [
      {
        "paramName": "command",
        "paramValue": "update",
        "type": "EQUALS"
      }
    ]
  },
  {
    "type": "GROUP",
    "name": "Other",
    "displayName": "Other",
    "groupStyle": "ZIPPY_OPEN",
    "subParams": [
      {
        "type": "CHECKBOX",
        "name": "url_passthrough",
        "checkboxText": "Ad Click Info in URLs",
        "simpleValueType": true
      },
      {
        "type": "CHECKBOX",
        "name": "ads_data_redaction",
        "checkboxText": "Redact Advertising Data",
        "simpleValueType": true
      }
    ]
  }
]


___SANDBOXED_JS_FOR_WEB_TEMPLATE___

const createArgumentsQueue = require('createArgumentsQueue');
const log = require('logToConsole');
const makeTableMap = require('makeTableMap');
const setDefaultConsentState = require('setDefaultConsentState');
const updateConsentState = require('updateConsentState');
const gtag = createArgumentsQueue('gtag', 'dataLayer');
const injectScript = require('injectScript');
const gtagSet = require('gtagSet');

// Adding Cookie Information Consent Banner and setting developer ID

const onSuccess = () => {
  data.gtmOnSuccess();
};

const onFailure = () => {
  data.gtmOnFailure();
};

const consentBanner = injectScript('https://policy.app.cookieinformation.com/uc.js', onSuccess, onFailure);
gtagSet('developer_id.dNmIyNz', true);

if (data.url_passthrough) gtagSet('url_passthrough', true);
if (data.ads_data_redaction) gtagSet('ads_data_redaction', true);

if (data.command === 'default') {
  data.settingsTable.forEach(setting => {
    const settingObject = {
      ad_storage: setting.ad_storage,
      analytics_storage: setting.analytics_storage,
      functionality_storage: setting.functionality_storage,
      personalization_storage: setting.personalization_storage,
      security_storage: setting.security_storage,
      wait_for_update: setting.wait_for_update,
    };
    const tagManagerConsent = {
      ad_storage: setting.ad_storage,
      analytics_storage: setting.analytics_storage,
      functionality_storage: setting.functionality_storage,
      personalization_storage: setting.personalization_storage,
      security_storage: setting.security_storage
    };
    if (setting.regions !== 'all') {
      settingObject.region = setting.regions.split(',').map(r => r.trim());
      tagManagerConsent.region = setting.regions.split(',').map(r => r.trim());
    }
    gtag('consent', 'default', settingObject);
    setDefaultConsentState(settingObject);    
  });
}

if (data.command === 'update') {
  gtag('consent', 'update', {
    ad_storage: data.ad_storage_update,
    analytics_storage: data.analytics_storage_update,
    functionality_storage: data.functionality_storage_update,
    personalization_storage: data.personalization_storage_update,
    security_storage: data.security_storage_update
  });
  updateConsentState({
    ad_storage: data.ad_storage_update,
    analytics_storage: data.analytics_storage_update,
    functionality_storage: data.functionality_storage_update,
    personalization_storage: data.personalization_storage_update,
    security_storage: data.security_storage_update
  });
}

// Call data.gtmOnSuccess when the tag is finished.
data.gtmOnSuccess();


___WEB_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "logging",
        "versionId": "1"
      },
      "param": [
        {
          "key": "environments",
          "value": {
            "type": 1,
            "string": "all"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "access_globals",
        "versionId": "1"
      },
      "param": [
        {
          "key": "keys",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "dataLayer"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": false
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "gtag"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": false
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "gtagSet"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": false
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "access_consent",
        "versionId": "1"
      },
      "param": [
        {
          "key": "consentTypes",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "consentType"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "ad_storage"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "consentType"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "analytics_storage"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "consentType"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "functionality_storage"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "consentType"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "personalization_storage"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "consentType"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "security_storage"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "consentType"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "wait_for_update"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "write_data_layer",
        "versionId": "1"
      },
      "param": [
        {
          "key": "keyPatterns",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "developer_id.dNmIyNz"
              },
              {
                "type": 1,
                "string": "url_passthrough"
              },
              {
                "type": 1,
                "string": "ads_data_redaction"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "inject_script",
        "versionId": "1"
      },
      "param": [
        {
          "key": "urls",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "https://policy.app.cookieinformation.com/uc.js"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  }
]


___TESTS___

scenarios:
- name: check gtag is created properly
  code: |-
    mock('createArgumentsQueue', (cmd, arr) => {
      assertThat(cmd).isEqualTo('gtag');
      assertThat(arr).isEqualTo('dataLayer');
      return () => {};
    });

    runCode(mockData);

    // Check that tag was correctly called
    assertApi('gtmOnSuccess').wasCalled();
- name: check default settings are sent
  code: |-
    // Mock data fields

    let index = 1;
    mock('createArgumentsQueue', () => {
      return function() {
        if (arguments[0] === 'consent' && index === 1) {
          assertThat(arguments[2]).isEqualTo({
            ad_storage: 'granted',
            analytics_storage: 'denied',
            wait_for_update: 500
          });
          index++;
        } else if (arguments[0] === 'consent' && index === 2) {
          assertThat(arguments[2]).isEqualTo({
            ad_storage: 'denied',
            analytics_storage: 'granted',
            wait_for_update: 1000,
            region: ['FR', 'US-CA']
          });
        }
      };
    });

    // Call runCode to run the template's code.
    runCode(mockData);

    // Verify that the tag finished successfully.
    assertApi('setDefaultConsentState').wasCalledWith({
      ad_storage: 'granted',
      analytics_storage: 'denied'
    });
    assertApi('setDefaultConsentState').wasCalledWith({
      ad_storage: 'denied',
      analytics_storage: 'granted',
      region: ['FR', 'US-CA']
    });
    assertApi('gtmOnSuccess').wasCalled();
- name: check that update settings are sent
  code: |-
    // Mock data fields

    mockData.command = 'update';

    mock('createArgumentsQueue', () => {
      return function() {
        if (arguments[0] === 'consent') {
          assertThat(arguments[2]).isEqualTo({
            ad_storage: 'denied',
            analytics_storage: 'granted'
          });
        }
      };
    });
    // Call runCode to run the template's code.
    runCode(mockData);

    // Verify that the tag finished successfully.
    assertApi('updateConsentState').wasCalledWith({
      ad_storage: 'denied',
      analytics_storage: 'granted'
    });
    assertApi('gtmOnSuccess').wasCalled();


___NOTES___

Created on 10.9.2021 08.43.51


